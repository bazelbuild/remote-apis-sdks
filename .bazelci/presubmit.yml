---
validate_config: 1
tasks:
  ubuntu1804:
    shell_commands:
      - "echo +++ Installing golang"
      - "mkdir -p /tmp/go-1.15/"
      - "wget https://golang.org/dl/go1.15.2.linux-amd64.tar.gz && tar -C /tmp/go-1.15/ -xzf go1.15.2.linux-amd64.tar.gz"
      - "export PATH=/tmp/go-1.15/go/bin:$PATH"
      - "echo +++ Check go format"
      - "go version"
      - "./check-gofmt.sh `find go -name '*.go'`"
      - "echo +++ Check go vet"
      - "go vet ./..."
    build_targets:
      - "//..."
    test_targets:
      - "//..."
# Check that "go build / test" works, too.
  ubuntu1804_gobuild:
    platform: ubuntu1804
    name: "go build / test"
    shell_commands:
      - "echo +++ Installing golang"
      - "mkdir -p /tmp/go-1.15/"
      - "wget https://golang.org/dl/go1.15.2.linux-amd64.tar.gz && tar -C /tmp/go-1.15/ -xzf go1.15.2.linux-amd64.tar.gz"
      - "export PATH=/tmp/go-1.15/go/bin:$PATH"
      - "echo +++ Running go build"
      - "go version"
      - "go build ./..."
      - "echo +++ Running go test"
      - "go test ./..."
